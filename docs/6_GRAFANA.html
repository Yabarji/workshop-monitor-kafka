<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Grafana | Workshop Monitoring Kafka</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="Monitor your Cluster">
    <link rel="preload" href="/workshop-monitor-kafka/assets/css/0.styles.5b0f8516.css" as="style"><link rel="preload" href="/workshop-monitor-kafka/assets/js/app.ff5aacc7.js" as="script"><link rel="preload" href="/workshop-monitor-kafka/assets/js/2.843781b4.js" as="script"><link rel="preload" href="/workshop-monitor-kafka/assets/js/12.a4beeb84.js" as="script"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/10.4c0a3e83.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/11.863a8251.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/13.f8be57f3.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/3.d8a31682.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/4.7d5f245c.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/5.67bbb12a.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/6.7438f4e3.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/7.e735cf3e.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/8.216e27f5.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/9.feffe9a4.js">
    <link rel="stylesheet" href="/workshop-monitor-kafka/assets/css/0.styles.5b0f8516.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/workshop-monitor-kafka/" class="home-link router-link-active"><img src="/workshop-monitor-kafka/kafka-logo.png" alt="Workshop Monitoring Kafka" class="logo"> <span class="site-name can-hide">Workshop Monitoring Kafka</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/vgallet/workshop-monitoring-kafka" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/vgallet/workshop-monitoring-kafka" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/workshop-monitor-kafka/1_GETTING_STARTED.html" class="sidebar-link">Getting Started</a></li><li><a href="/workshop-monitor-kafka/2_MANUAL_CHECKS.html" class="sidebar-link">Manual Checks</a></li><li><a href="/workshop-monitor-kafka/3_INJECT_DATA.html" class="sidebar-link">Inject some data</a></li><li><a href="/workshop-monitor-kafka/3_OFF_THE_SHELF.html" class="sidebar-link">Off-the-shelf tools</a></li><li><a href="/workshop-monitor-kafka/4_JMX.html" class="sidebar-link">JMX Metrics</a></li><li><a href="/workshop-monitor-kafka/5_JMX_EXPORTER_PROMETHEUS.html" class="sidebar-link">JMX Exporter &amp; Prometheus</a></li><li><a href="/workshop-monitor-kafka/6_GRAFANA.html" aria-current="page" class="active sidebar-link">Grafana</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/workshop-monitor-kafka/6_GRAFANA.html#data-source" class="sidebar-link">Data Source</a></li><li class="sidebar-sub-header"><a href="/workshop-monitor-kafka/6_GRAFANA.html#default-dashboard" class="sidebar-link">Default Dashboard</a></li><li class="sidebar-sub-header"><a href="/workshop-monitor-kafka/6_GRAFANA.html#create-your-dashboard" class="sidebar-link">Create your dashboard</a></li></ul></li><li><a href="/workshop-monitor-kafka/10_GLOSSARY.html" class="sidebar-link">Glossary</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="grafana"><a href="#grafana" class="header-anchor">#</a> Grafana</h1> <div style="text-align:center;"><img src="logo-grafana.png"></div> <blockquote><p><a href="https://github.com/grafana/grafana" target="_blank" rel="noopener noreferrer">Grafana<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> allows you to query, visualize, alert on and understand your metrics no matter where they are stored.</p></blockquote> <p>Grafana will help us visualize our metrics into dashboards. It comes bundled with rich support for many of the most popular time series databases like Graphite, Prometheus, Elasticsearch, OpenTSDB and InfluxDB.
Grafana supports querying Prometheus. The Grafana data source for Prometheus is included since Grafana 2.5.0 (2015-10-28).</p> <p>Go to <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">Grafana<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and log in as <code>admin</code> <code>admin</code> (confirm your password)</p> <h2 id="data-source"><a href="#data-source" class="header-anchor">#</a> Data Source</h2> <p>This Grafana instance is already configured to use the Prometheus database. You can check it by going to <a href="http://localhost:3000/datasources" target="_blank" rel="noopener noreferrer">Configuration/Data Sources<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div style="text-align:center;"><img src="prometheus_datasource.png"></div> <h2 id="default-dashboard"><a href="#default-dashboard" class="header-anchor">#</a> Default Dashboard</h2> <p>Some dashboards are bundled in this workshop. This will help you get used to Grafana and create your own dashboard.</p> <h3 id="global-dashboard"><a href="#global-dashboard" class="header-anchor">#</a> Global Dashboard</h3> <p>Look at the Global dashboard. You should see all the Apache Kafka and Apache ZooKeeper instances listed. It should also show that all the instances are healthy.</p> <div style="text-align:center;"><img src="global_dashboard.png"></div> <h3 id="jvm-dashboard"><a href="#jvm-dashboard" class="header-anchor">#</a> JVM Dashboard</h3> <p>Next, look at the dashboard <code>Kafka Broker / JVM Memory</code>.</p> <div style="text-align:center;"><img src="broker_jvm.png"></div> <p>This dashboard has a row per instance. It shows the JVM's used heap memory and the time spend in GC per generation for each instance.</p> <h2 id="create-your-dashboard"><a href="#create-your-dashboard" class="header-anchor">#</a> Create your dashboard</h2> <p>Create a new dashboard. On the top left, click on the floppy disk icon to save and name your dashboard as <code>Kafka Dashboard</code>.</p> <h3 id="instance-variable"><a href="#instance-variable" class="header-anchor">#</a> Instance Variable</h3> <p>Next, click on the gearwheel at the top left. You are going to create a new variable to filter your dashboard per instance. Click <code>Variables</code> and <code>add variable</code>.</p> <p>Name your variable <code>instance</code>, choose the Prometheus data source and set the regex as <code>label_values(instance)</code></p> <div style="text-align:center;"><img src="instance_variable.png"></div> <p>You should see the instances in the section <code>Preview of values</code>.</p> <p>Finally, press <code>Save Dashboard</code></p> <h3 id="active-controller-panel"><a href="#active-controller-panel" class="header-anchor">#</a> Active Controller Panel</h3> <p>Click on ̀ Add a new panel`, You are going to create a new panel to display which Apache Kafka instance is the controller.</p> <p>On the left, in the <code>Settings</code> section, set the title to <code>Active Controller</code> and choose Table Visualization.</p> <p>In the <code>Query</code> section, set the metrics as <code>kafka_controller_kafkacontroller_activecontrollercount</code>. You should see all the data for this metric.</p> <p>As you can see, the metric is updated every 15 seconds. This interval is configured in the <code>prometheus.yml</code> file.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">global</span><span class="token punctuation">:</span>
  <span class="token key atrule">scrape_interval</span><span class="token punctuation">:</span>     15s
</code></pre></div><p>For this panel, you only need the last value, so you can toggle the <code>Instant</code> button in the <code>Legend</code> section.</p> <blockquote><p>An Instant Query returns the last value for each time series which shows a good summary of the data shown in the graph.
<a href="https://grafana.com/docs/grafana/latest/explore/#prometheus-specific-features" target="_blank" rel="noopener noreferrer">Grafana Documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>Finally, click on the <code>Transform</code> tab, select <code>Organize fields</code> to hide useless columns like <code>job</code>, <code>time</code> and <code>__name__</code>.
Your table should look like this:</p> <div style="text-align:center;"><img src="active_controller_panel.png"></div> <p>Don't forget to click on the <code>Save</code> button.</p> <h3 id="your-turn-to-play"><a href="#your-turn-to-play" class="header-anchor">#</a> Your turn to play</h3> <p>Now that you have the keys. We let you make your own dashboard.</p> <div style="text-align:center;"><img src="kafka_dashboard.png"></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/workshop-monitor-kafka/5_JMX_EXPORTER_PROMETHEUS.html" class="prev">
        JMX Exporter &amp; Prometheus
      </a></span> <span class="next"><a href="/workshop-monitor-kafka/10_GLOSSARY.html">
        Glossary
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/workshop-monitor-kafka/assets/js/app.ff5aacc7.js" defer></script><script src="/workshop-monitor-kafka/assets/js/2.843781b4.js" defer></script><script src="/workshop-monitor-kafka/assets/js/12.a4beeb84.js" defer></script>
  </body>
</html>
