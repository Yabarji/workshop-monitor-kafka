(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{355:function(e,t,a){"use strict";a.r(t);var r=a(42),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"grafana"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#grafana"}},[e._v("#")]),e._v(" Grafana")]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"logo-grafana.png"}})]),e._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://github.com/grafana/grafana",target:"_blank",rel:"noopener noreferrer"}},[e._v("Grafana"),a("OutboundLink")],1),e._v(" allows you to query, visualize, alert on and understand your metrics no matter where they are stored.")])]),e._v(" "),a("p",[e._v("Grafana will help us visualize our metrics into dashboards. It comes bundled with rich support for many of the most popular time series databases like Graphite, Prometheus, Elasticsearch, OpenTSDB and InfluxDB.\nGrafana supports querying Prometheus. The Grafana data source for Prometheus is included since Grafana 2.5.0 (2015-10-28).")]),e._v(" "),a("p",[e._v("Go to "),a("a",{attrs:{href:"http://localhost:3000",target:"_blank",rel:"noopener noreferrer"}},[e._v("Grafana"),a("OutboundLink")],1),e._v(" and log in as "),a("code",[e._v("admin")]),e._v(" "),a("code",[e._v("admin")]),e._v(" (confirm your password)")]),e._v(" "),a("h2",{attrs:{id:"data-source"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source"}},[e._v("#")]),e._v(" Data Source")]),e._v(" "),a("p",[e._v("This Grafana instance is already configured to use the Prometheus database. You can check it by going to "),a("a",{attrs:{href:"http://localhost:3000/datasources",target:"_blank",rel:"noopener noreferrer"}},[e._v("Configuration/Data Sources"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"prometheus_datasource.png"}})]),e._v(" "),a("h2",{attrs:{id:"default-dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#default-dashboard"}},[e._v("#")]),e._v(" Default Dashboard")]),e._v(" "),a("p",[e._v("Some dashboards are bundled in this workshop. This will help you get used to Grafana and create your own dashboard.")]),e._v(" "),a("h3",{attrs:{id:"global-dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#global-dashboard"}},[e._v("#")]),e._v(" Global Dashboard")]),e._v(" "),a("p",[e._v("Look at the Global dashboard. You should see all the Apache Kafka and Apache ZooKeeper instances listed. It should also show that all the instances are healthy.")]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"global_dashboard.png"}})]),e._v(" "),a("h3",{attrs:{id:"jvm-dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm-dashboard"}},[e._v("#")]),e._v(" JVM Dashboard")]),e._v(" "),a("p",[e._v("Next, look at the dashboard "),a("code",[e._v("Kafka Broker / JVM Memory")]),e._v(".")]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"broker_jvm.png"}})]),e._v(" "),a("p",[e._v("This dashboard has a row per instance. It shows the JVM's used heap memory and the time spend in GC per generation for each instance.")]),e._v(" "),a("h2",{attrs:{id:"create-your-dashboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-your-dashboard"}},[e._v("#")]),e._v(" Create your dashboard")]),e._v(" "),a("p",[e._v("Create a new dashboard. On the top left, click on the floppy disk icon to save and name your dashboard as "),a("code",[e._v("Kafka Dashboard")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"instance-variable"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#instance-variable"}},[e._v("#")]),e._v(" Instance Variable")]),e._v(" "),a("p",[e._v("Next, click on the gearwheel at the top left. You are going to create a new variable to filter your dashboard per instance. Click "),a("code",[e._v("Variables")]),e._v(" and "),a("code",[e._v("add variable")]),e._v(".")]),e._v(" "),a("p",[e._v("Name your variable "),a("code",[e._v("instance")]),e._v(", choose the Prometheus data source and set the regex as "),a("code",[e._v("label_values(instance)")])]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"instance_variable.png"}})]),e._v(" "),a("p",[e._v("You should see the instances in the section "),a("code",[e._v("Preview of values")]),e._v(".")]),e._v(" "),a("p",[e._v("Finally, press "),a("code",[e._v("Save Dashboard")])]),e._v(" "),a("h3",{attrs:{id:"active-controller-panel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#active-controller-panel"}},[e._v("#")]),e._v(" Active Controller Panel")]),e._v(" "),a("p",[e._v("Click on Ì€ Add a new panel`, You are going to create a new panel to display which Apache Kafka instance is the controller.")]),e._v(" "),a("p",[e._v("On the left, in the "),a("code",[e._v("Settings")]),e._v(" section, set the title to "),a("code",[e._v("Active Controller")]),e._v(" and choose Table Visualization.")]),e._v(" "),a("p",[e._v("In the "),a("code",[e._v("Query")]),e._v(" section, set the metrics as "),a("code",[e._v("kafka_controller_kafkacontroller_activecontrollercount")]),e._v(". You should see all the data for this metric.")]),e._v(" "),a("p",[e._v("As you can see, the metric is updated every 15 seconds. This interval is configured in the "),a("code",[e._v("prometheus.yml")]),e._v(" file.")]),e._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("global")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("scrape_interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("     15s\n")])])]),a("p",[e._v("For this panel, you only need the last value, so you can toggle the "),a("code",[e._v("Instant")]),e._v(" button in the "),a("code",[e._v("Legend")]),e._v(" section.")]),e._v(" "),a("blockquote",[a("p",[e._v("An Instant Query returns the last value for each time series which shows a good summary of the data shown in the graph.\n"),a("a",{attrs:{href:"https://grafana.com/docs/grafana/latest/explore/#prometheus-specific-features",target:"_blank",rel:"noopener noreferrer"}},[e._v("Grafana Documentation"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("Finally, click on the "),a("code",[e._v("Transform")]),e._v(" tab, select "),a("code",[e._v("Organize fields")]),e._v(" to hide useless columns like "),a("code",[e._v("job")]),e._v(", "),a("code",[e._v("time")]),e._v(" and "),a("code",[e._v("__name__")]),e._v(".\nYour table should look like this:")]),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"active_controller_panel.png"}})]),e._v(" "),a("p",[e._v("Don't forget to click on the "),a("code",[e._v("Save")]),e._v(" button.")]),e._v(" "),a("h3",{attrs:{id:"your-turn-to-play"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#your-turn-to-play"}},[e._v("#")]),e._v(" Your turn to play")]),e._v(" "),a("p",[e._v("Now that you have the keys. We let you make your own dashboard.\nTo help you or give you an example of metrics to monitor.\nWe let you pick from the list below.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Metrics")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("ActiveControllerCount")]),e._v(" "),a("td",[e._v("Number of active controller in the cluster. "),a("strong",[e._v("There must be only one controller!")])])]),e._v(" "),a("tr",[a("td",[e._v("ZooKeeperExpiresPerSec")]),e._v(" "),a("td",[e._v("A Zookeeper session has expired. It can lead to a new leader election or even a new controller election.")])]),e._v(" "),a("tr",[a("td",[e._v("OfflinePartitionsCount")]),e._v(" "),a("td",[e._v("Number of offline partitions. It means that those partitions have no leader anymore and so they are unavailable to read and write operations.")])]),e._v(" "),a("tr",[a("td",[e._v("ConsumerLag")]),e._v(" "),a("td",[e._v("Lag in number of messages per follower replica. This is useful to know if the replica is slow or has stopped replicating from the leader.")])]),e._v(" "),a("tr",[a("td",[e._v("UnderReplicatedPartitions")]),e._v(" "),a("td",[e._v("Number of under-replicated partitions. It indicates the number of partitions that have not a complete list of ISR. You must be alert when this value is greater than zero.")])]),e._v(" "),a("tr",[a("td",[e._v("IsrShrinksPerSec")]),e._v(" "),a("td",[e._v("A shrinkage has occurred to the ISR list. It can be due to a network problem or because a broker goes down.")])]),e._v(" "),a("tr",[a("td",[e._v("IsrExpandsPerSec")]),e._v(" "),a("td",[e._v("It shows an increase in the number of replicas in the ISR list. IsrShrinksPerSec and IsrExpandsPerSec must not change and be equal to zero.")])]),e._v(" "),a("tr",[a("td",[e._v("BytesInPerSec / BytesOutPerSec")]),e._v(" "),a("td",[e._v("Incoming and Outgoing bytes per second, all topics combined. Those metrics do not include ReplicationBytesInPerSec and ReplicationBytesOutPerSec.")])]),e._v(" "),a("tr",[a("td",[e._v("MessagesInPerSec")]),e._v(" "),a("td",[e._v("Incoming message rate per second, all topics combined.")])]),e._v(" "),a("tr",[a("td",[e._v("UncleanLeaderElectionsPerSec")]),e._v(" "),a("td",[e._v("Unclean leader election rate. A new partition leader has been elected which is not from ISR. It's only possible when "),a("code",[e._v("unclean.leader.election.enable")]),e._v(" is set to true, default is false")])]),e._v(" "),a("tr",[a("td",[e._v("RequestHandlerAvgIdlePercent")]),e._v(" "),a("td",[e._v("Average fraction of time the request handler threads are idle. Values are between 0 (all resources are used) and 1 (all resources are available).")])]),e._v(" "),a("tr",[a("td",[e._v("TotalTimeMs request={Produce|FetchConsumer|FetchFollower}")]),e._v(" "),a("td",[e._v("Total time in ms to serve the specified request.")])])])])])}),[],!1,null,null,null);t.default=o.exports}}]);