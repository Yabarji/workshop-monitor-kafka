<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Manual Checks | Workshop Monitoring Kafka</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="Monitor your Cluster">
    <link rel="preload" href="/workshop-monitor-kafka/assets/css/0.styles.5b0f8516.css" as="style"><link rel="preload" href="/workshop-monitor-kafka/assets/js/app.7696751f.js" as="script"><link rel="preload" href="/workshop-monitor-kafka/assets/js/2.843781b4.js" as="script"><link rel="preload" href="/workshop-monitor-kafka/assets/js/7.0881a52f.js" as="script"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/10.2eac8ea3.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/11.37b5992f.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/12.65818860.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/13.167d9b4c.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/3.d8a31682.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/4.7d5f245c.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/5.305d9f2b.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/6.6698b48b.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/8.cf896f7d.js"><link rel="prefetch" href="/workshop-monitor-kafka/assets/js/9.b8eefba0.js">
    <link rel="stylesheet" href="/workshop-monitor-kafka/assets/css/0.styles.5b0f8516.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/workshop-monitor-kafka/" class="home-link router-link-active"><img src="/workshop-monitor-kafka/kafka-logo.png" alt="Workshop Monitoring Kafka" class="logo"> <span class="site-name can-hide">Workshop Monitoring Kafka</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/vgallet/workshop-monitoring-kafka" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/vgallet/workshop-monitoring-kafka" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/workshop-monitor-kafka/1_GETTING_STARTED.html" class="sidebar-link">Getting Started</a></li><li><a href="/workshop-monitor-kafka/2_MANUAL_CHECKS.html" aria-current="page" class="active sidebar-link">Manual Checks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/workshop-monitor-kafka/2_MANUAL_CHECKS.html#apache-zookeeper" class="sidebar-link">Apache Zookeeper</a></li><li class="sidebar-sub-header"><a href="/workshop-monitor-kafka/2_MANUAL_CHECKS.html#zookeeper-commands-the-four-letter-words" class="sidebar-link">ZooKeeper Commands: The Four Letter Words</a></li><li class="sidebar-sub-header"><a href="/workshop-monitor-kafka/2_MANUAL_CHECKS.html#apache-kafka" class="sidebar-link">Apache Kafka</a></li></ul></li><li><a href="/workshop-monitor-kafka/3_INJECT_DATA.html" class="sidebar-link">Inject some data</a></li><li><a href="/workshop-monitor-kafka/3_OFF_THE_SHELF.html" class="sidebar-link">Off-the-shelf tools</a></li><li><a href="/workshop-monitor-kafka/4_JMX.html" class="sidebar-link">JMX Metrics</a></li><li><a href="/workshop-monitor-kafka/5_JMX_EXPORTER_PROMETHEUS.html" class="sidebar-link">JMX Exporter &amp; Prometheus</a></li><li><a href="/workshop-monitor-kafka/6_GRAFANA.html" class="sidebar-link">Grafana</a></li><li><a href="/workshop-monitor-kafka/10_GLOSSARY.html" class="sidebar-link">Glossary</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="manual-checks"><a href="#manual-checks" class="header-anchor">#</a> Manual Checks</h1> <h2 id="apache-zookeeper"><a href="#apache-zookeeper" class="header-anchor">#</a> Apache Zookeeper</h2> <p>As the cluster is now ready, we will make sure that Apache Zookeeper works fine.
Connect to the Apache Zookeeper node:</p> <p>For example</p> <div class="language- extra-class"><pre class="language-text"><code>docker-compose -f kafka-cluster.yml exec zk-1 bash
</code></pre></div><p>Once connected, use the <code>zooKeeper-shell</code> command to check the cluster's state:</p> <div class="language- extra-class"><pre class="language-text"><code>zookeeper-shell 127.0.0.1:2181
</code></pre></div><p>Check out the root nodes with the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>ls /
[admin, brokers, cluster, config, consumers, controller, controller_epoch, isr_change_notification, latest_producer_id_block, log_dir_event_notification, schema_registry, zookeeper]
</code></pre></div><p>Now let's make sure that the node is well registered:</p> <div class="language- extra-class"><pre class="language-text"><code>ls /brokers/ids # Gives the list of active brokers
ls /brokers/topics #Gives the list of topics
get /brokers/ids/0 #Gives more detailed information of the broker id '0'
</code></pre></div><h2 id="zookeeper-commands-the-four-letter-words"><a href="#zookeeper-commands-the-four-letter-words" class="header-anchor">#</a> ZooKeeper Commands: The Four Letter Words</h2> <blockquote><p>ZooKeeper responds to a small set of commands. Each command is composed of four letters. You can issue the commands to ZooKeeper via telnet or nc, at the client port.*
<a href="https://zookeeper.apache.org/doc/r3.1.2/zookeeperAdmin.html" target="_blank" rel="noopener noreferrer">Apache Zookeeper documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>To be able to use the commands, add the following option when starting the application
<code>KAFKA_OPTS: &quot;-Dzookeeper.4lw.commands.whitelist=*&quot;</code></p> <p>Check if server is running in a non-error state. The server will respond with <code>imok</code> if it is running. Otherwise it will not respond at all.
Here's an example of the ruok command:</p> <div class="language- extra-class"><pre class="language-text"><code>echo ruok | nc 127.0.0.1 2181
imok
</code></pre></div><p>Find all commands in the documentation Apache Zookeeper
<a href="https://zookeeper.apache.org/doc/r3.1.2/zookeeperAdmin.html" target="_blank" rel="noopener noreferrer">Apache Zookeeper documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>A work is in progress to remove the Apache ZooKeeper Dependency.
You can follow it with this <a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-500%3A+Replace+ZooKeeper+with+a+Self-Managed+Metadata+Quorum" target="_blank" rel="noopener noreferrer">KIP-500<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and read more about it in <a href="https://www.confluent.io/blog/removing-zookeeper-dependency-in-kafka/" target="_blank" rel="noopener noreferrer">this blog post<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <h2 id="apache-kafka"><a href="#apache-kafka" class="header-anchor">#</a> Apache Kafka</h2> <h3 id="logs"><a href="#logs" class="header-anchor">#</a> Logs</h3> <p>Like any other application, it's possible to browse logs to verify that the broker is running correctly.
Confluent Docker images are configured to send all logs to <code>stdout</code> by default. The configuration is written in the <code>/etc/kafka/log4j.properties</code> file.</p> <p>To browse these logs:</p> <div class="language-shell script extra-class"><pre class="language-shell"><code>docker-compose -f kafka-cluster.yml logs kafka-1
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Add <code>-f</code> or <code>--follow</code> to continue streaming the logs</p></div> <p>With a classic installation, the broker will write its logs in several files inside <code>/var/log/kafka</code>:</p> <p><a href="https://docs.confluent.io/1.0.1/kafka/post-deployment.html#logging" target="_blank" rel="noopener noreferrer"><code>server.log</code> file<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>The logs from the server go to logs/server.log.</p></blockquote> <p><a href="https://docs.confluent.io/1.0.1/kafka/post-deployment.html#controller" target="_blank" rel="noopener noreferrer"><code>controller.log</code> file<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>The controller is responsible for cluster management and handles events like broker failures, leader election, topic deletion and more.</p></blockquote> <p><a href="https://docs.confluent.io/1.0.1/kafka/post-deployment.html#state-change-log" target="_blank" rel="noopener noreferrer"><code>state-change.log</code> file<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>The controller does state management for all resources in the Kafka cluster.
This includes topics, partitions, brokers and replicas. As part of state management, when the state of any resource is changed by the controller,
it logs the action to a special state change log stored under logs/state-change.log.</p></blockquote> <p><code>log-cleaner.log</code> contains logs from LogCleaner and topic compaction activities.</p> <p>Here's default <a href="https://github.com/apache/kafka/blob/trunk/config/log4j.properties" target="_blank" rel="noopener noreferrer"><code>log4j.properties</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/workshop-monitor-kafka/1_GETTING_STARTED.html" class="prev">
        Getting Started
      </a></span> <span class="next"><a href="/workshop-monitor-kafka/3_INJECT_DATA.html">
        Inject some data
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/workshop-monitor-kafka/assets/js/app.7696751f.js" defer></script><script src="/workshop-monitor-kafka/assets/js/2.843781b4.js" defer></script><script src="/workshop-monitor-kafka/assets/js/7.0881a52f.js" defer></script>
  </body>
</html>
